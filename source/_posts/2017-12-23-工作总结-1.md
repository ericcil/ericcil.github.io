---
title: 工作总结(1)
date: 2017-12-23 20:40:21
tags:
category:
---


### 

<!-- more -->

&emsp;&emsp;休息了一天，现在总算懒完了，开始写下工作的一些总结。首先要从工作内容开始介绍吧。项目组最早是做现金贷业务，从项目组成立到现在，其中也经历了许多次业务调整，目前在做分期商城这类的应用。这期间也遇到了不少坑，业务上的、技术上的。
&emsp;&emsp;从业务上讨论，订单业务是很重要的一块，这同时也是我们系统中发生异常最多的部分。项目初期订单业务功能非常单一，用户下单，记录订单明细，与核心系统交互获取分期信息。后来随着项目迭代，业务上的功能也越堆越多，加上负责订单部分的开发经验不足，造成代码耦合度，冗余度都非常高，更严重的是在线上运行的时候经常会抛出异常，影响用户使用。

### 具体问题
* 事务控制
&emsp;&emsp;事务的控制一般也只是提及“隔离级别”和“传播行为”。由于spring提供了对事务的支持，一般开发的时候我们就很少考虑这些事务细节。不过作为业务的实现者，还有一个很重要的问题需要考虑。那就是__对数据库做的哪些操作，我们要整合成一个事务。__
&emsp;&emsp;随着业务增长，我们需要有了开票功能、短信通知，有时还需要通知下游系统同步数据。但是这不意味着需要把这些功能都加入到订单的事务中去，倘若其中发生一个异常，那正常的下单功能也会受到影响，直接回滚。更可怕的是其中还有付款的业务，这都是调用第三方的接口，接口调用是无法回滚的，可能会造成用户已经被扣款，而我们系统内部却没有记录。
&emsp;&emsp;这部分的内容，其实和技术基本没有关联，主要是开发人员对于业务的理解。很大程度上需要开发人员多思考业务内容，避免一些不相关事务之间的相互影响，或者低优先级业务直接影响高优先级业务的实现。
* 耦合
&emsp;&emsp;耦合是编程中经常出现的词，解耦的话题常常挂在我们嘴边。这个话题也很大，我的切入点依然是业务，比较业务系统中，脱离业务谈代码也是耍流氓。两个业务功能模块之间的耦合度应该尽量小。就如在审核功能中需要增加开票，这是两个业务功能，假如我们将整个开票功能加入到审核功能，那么在代码执行时开票的执行结果（是否产生异常）肯定会影响到正常的审核业务。我们可以将开票的主体功能抽离，暴露出一个开票任务的启动接口，让开票的过程与结果不影响审核。
&emsp;&emsp;当然也并不是所有的业务功能都能解耦，原则上是：任务结果反馈实时性要求低的业务最适合抽离。